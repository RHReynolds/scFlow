<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A Single-Cell/Nuclei Analysis Toolkit • scFlow</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="A Single-Cell/Nuclei Analysis Toolkit">
<meta property="og:description" content="Single-cell/nuclei RNA-seq analysis tools in R to build a complete analysis workflow.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">scFlow</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/basic-qc.html">scFlow: Guided Tutorial for Sample QC</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/combiz/scFlow">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="scFlow" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#scFlow" class="anchor"></a>scFlow</h1></div>
<!-- badges: start -->

<p>The goal of scFlow is to provide tools in R to build a complete analysis workflow for single-cell/nuclei RNA sequencing data.</p>
<ul>
<li>Quality control of gene-cell matrices
<ul>
<li>Filtering of matrices by counts and features</li>
<li>Filtering of mitochondrial genes and mitochondrial counts thresholding</li>
<li>Doublet and multiplet identification and removal with <a href="https://github.com/chris-mcginnis-ucsf/DoubletFinder">DoubletFinder</a>
</li>
<li>Rich QC metrics annotation with <a href="https://github.com/davismcc/scater">scater</a>
</li>
</ul>
</li>
<li>Dimensionality reduction and celltype identification
<ul>
<li>Louvain clustering, UMAP dimensionality reduction, and cluster marker gene identification with <a href="https://github.com/cole-trapnell-lab/monocle-release">monocle</a>
</li>
<li>Celltype annotation with <a href="https://github.com/NathanSkene/EWCE">EWCE</a> and <a href="https://github.com/MacoskoLab/liger">Liger</a>
</li>
<li>Cluster identity mapping against the <a href="https://www.brain-map.org">Allen Human Brain Atlas</a> and Mouse Nervous System Data from <a href="https://doi.org/10.1016/j.cell.2018.06.021">Zeisel 2018</a>
</li>
</ul>
</li>
<li>Differential gene expression implementations
<ul>
<li>Zero-inflated regression model with <a href="https://github.com/RGLab/MAST">MAST</a>
</li>
<li>Random effects model with <a href="https://github.com/cran/limma">Limma</a>
</li>
<li>Negative binomial distribution pseudobulking model with <a href="https://github.com/mikelove/DESeq2">DESeq2</a>
</li>
<li>Pseudobulk generalized likelihood ratio tests with <a href="https://github.com/StoreyLab/edge">EdgeR</a>
</li>
</ul>
</li>
<li>Pathway and functional category enrichment analysis
<ul>
<li>Interface to the Enrichr database with <a href="https://github.com/cran/enrichR">EnrichR</a>
</li>
<li>Interface to the WebGestalt tool with <a href="http://www.webgestalt.org/">WebGestaltR</a>
</li>
</ul>
</li>
<li>Publication quality plots and analysis reports
<ul>
<li>QC plots and tabular metrics suitable for reports.</li>
<li>UMAP plots for cell features and gene expression.</li>
<li>Violin plots for gene expression.</li>
<li>Pathway and gene enrichment plots</li>
</ul>
</li>
</ul>
<p>The package functions are designed to interface neatly with <a href="https://www.nextflow.io/">NextFlow</a> for scalable and containerized pipelines deployed locally, on high-performance computing clusters, or in the cloud. An accompanying NextFlow pipeline is in the works - TBA.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You must have hdf5 setup on your system to run this. If using linux, run “sudo apt-get install libhdf5-dev”.</p>
<p>You can install the development version of scFlow from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"combiz/scFlow"</span>)</a></code></pre></div>
<p>An additional data package <code>scFlowData</code> will be needed which contains supplimentary data required for gene annotaion, cell type annotation, pathway analysis. Install that with:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"combiz/scFlowData"</span>)</a></code></pre></div>
</div>
<div id="developers" class="section level2">
<h2 class="hasAnchor">
<a href="#developers" class="anchor"></a>Developers</h2>
<p>You may need to install scFlow using a Personal Access Token (Github-&gt;Settings-&gt;Developer Settings): -</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># install.packages("devtools")</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"combiz/scFlow"</span>, <span class="dt">auth_token =</span> <span class="st">"YOURTOKEN"</span>)</a></code></pre></div>
<p>See <a href="https://github.com/combiz/scFlow/wiki/Installing-scFlow-from-a-private-github-repo">this page on the wiki</a> for a full explanation. For dependecy related issues check this <a href="https://github.com/combiz/scFlow/wiki">link</a>.</p>
</div>
<div id="preprocessing-example-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#preprocessing-example-dataset" class="anchor"></a>Preprocessing example dataset</h2>
<div id="prerequisite" class="section level3">
<h3 class="hasAnchor">
<a href="#prerequisite" class="anchor"></a>Prerequisite</h3>
<p>To preprocess scFlowExamples dataset, the following packages should be installed.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/ns-load.html">requireNamespace</a></span>(<span class="st">"BiocManager"</span>, <span class="dt">quietly =</span> <span class="ot">TRUE</span>)) {</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"BiocManager"</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">}</a>
<a class="sourceLine" id="cb4-4" data-line-number="4">BiocManager<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/BiocManager/man/install.html">install</a></span>(<span class="st">"DropletUtils"</span>)</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"ids"</span>)</a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"NathanSkene/One2One"</span>)</a></code></pre></div>
</div>
<div id="install-the-dataset-repository" class="section level3">
<h3 class="hasAnchor">
<a href="#install-the-dataset-repository" class="anchor"></a>Install the dataset repository</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/remote-reexports.html">install_github</a></span>(<span class="st">"neurogenomics/scFlowExample"</span>)</a></code></pre></div>
</div>
<div id="preparing-data-for-scFlow" class="section level3">
<h3 class="hasAnchor">
<a href="#preparing-data-for-scFlow" class="anchor"></a>Preparing data for <em>scFlow</em>
</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(scFlowExamples)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">indvExp &lt;-<span class="st"> </span>scFlowExamples<span class="op">::</span>indvExp</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co"># Create a folder to store the 10xGenomics matrix format data</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">output_path &lt;-<span class="st"> "~/tmp_ZeiselSCFLOW"</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="kw"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span>(output_path)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(indvExp)) {</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  x &lt;-<span class="st"> </span>indvExp[[i]]<span class="op">$</span>exp</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">  </a>
<a class="sourceLine" id="cb6-12" data-line-number="12">  <span class="co"># Convert gene symbols from mouse to human</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13">  <span class="co"># Limit genes to Mouse:Human orthologs</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14">  <span class="co"># Convert human gene symbols to Ensembl gene IDs</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15">  </a>
<a class="sourceLine" id="cb6-16" data-line-number="16">  x &lt;-<span class="st"> </span><span class="kw">mouse_symbol_to_human_ensembl</span>(x)</a>
<a class="sourceLine" id="cb6-17" data-line-number="17">  </a>
<a class="sourceLine" id="cb6-18" data-line-number="18">  <span class="co"># Write the data</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"></a>
<a class="sourceLine" id="cb6-20" data-line-number="20">  output_file &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%s/individual_%s"</span>, output_path, i)</a>
<a class="sourceLine" id="cb6-21" data-line-number="21">  DropletUtils<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/DropletUtils/man/write10xCounts.html">write10xCounts</a></span>(output_file, x,</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">    <span class="dt">barcodes =</span> <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(x), <span class="dt">gene.id =</span> <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(x),</a>
<a class="sourceLine" id="cb6-23" data-line-number="23">    <span class="dt">gene.symbol =</span> <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(x), <span class="dt">gene.type =</span> <span class="st">"Gene Expression"</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb6-24" data-line-number="24">    <span class="dt">type =</span> <span class="st">"auto"</span>, <span class="dt">genome =</span> <span class="st">"unknown"</span>, <span class="dt">version =</span> <span class="st">"3"</span></a>
<a class="sourceLine" id="cb6-25" data-line-number="25">  )</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">}</a></code></pre></div>
</div>
<div id="create-the-manifesto-file-for-scFlow" class="section level3">
<h3 class="hasAnchor">
<a href="#create-the-manifesto-file-for-scFlow" class="anchor"></a>Create the manifesto file for <em>scFlow</em>
</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">y &lt;-<span class="st"> </span>ids<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/ids/man/proquint.html">proquint</a></span>(<span class="dt">n =</span> <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(indvExp), <span class="dt">n_words =</span> 1L, <span class="dt">use_cache =</span> <span class="ot">TRUE</span>, <span class="dt">use_openssl =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">z &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="dt">key =</span> y, <span class="dt">filepath =</span> <span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%s/%s"</span>, output_path, <span class="kw"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span>(output_path, <span class="dt">pattern =</span> <span class="st">"individual"</span>)), <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span>(z, <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%s/Manifest.txt"</span>, output_path), <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>, <span class="dt">quote =</span> <span class="ot">FALSE</span>, <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</a></code></pre></div>
</div>
<div id="create-the-sample-sheet-for-scFlow" class="section level3">
<h3 class="hasAnchor">
<a href="#create-the-sample-sheet-for-scFlow" class="anchor"></a>Create the sample sheet for <em>scFlow</em>
</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">dx &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/unlist.html">unlist</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(indvExp, <span class="dt">FUN =</span> <span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span>(x<span class="op">$</span>dx)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">}))</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">sex &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"M"</span>, <span class="st">"F"</span>), <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(dx), <span class="dt">replace =</span> T)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">age &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="kw"><a href="https://rdrr.io/r/base/length.html">length</a></span>(dx))</a>
<a class="sourceLine" id="cb8-6" data-line-number="6">sample_sheet &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dt">manifest =</span> z[, <span class="dv">1</span>], <span class="dt">individual =</span> <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(z), <span class="dt">diagnosis =</span> dx, <span class="dt">sex =</span> sex)</a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/utils/write.table.html">write.table</a></span>(sample_sheet, <span class="dt">file =</span> <span class="kw"><a href="https://rdrr.io/r/base/sprintf.html">sprintf</a></span>(<span class="st">"%s/SampleSheet.tsv"</span>, output_path), <span class="dt">row.names =</span> <span class="ot">FALSE</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>, <span class="dt">quote =</span> <span class="ot">FALSE</span>, <span class="dt">sep =</span> <span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</a></code></pre></div>
<p>For a detailed explanation on how <code>scFlowExample</code> dataset was generated, visit this <a href="https://github.com/neurogenomics/scFlowExample">link</a>.</p>
</div>
</div>
<div id="running-scFlow" class="section level2">
<h2 class="hasAnchor">
<a href="#running-scFlow" class="anchor"></a>Running <em>scFlow</em>
</h2>
<p>The <code>scFlow</code> pipeline requires three main input: a folder containing <code>matrix.mtx.gz</code>, <code>features.tsv.gz</code>, <code>barcodes.tsv.gz</code> for individual samples, a SampleSheet.tsv file which is a tab-separated-variable file with sample metadata and a Manifest.txt file is a tab-separated-variable file with two columns: <code>key</code> and <code>filepath</code>. Details of how to generate the files is given in this <a href="https://github.com/combiz/scFlow/wiki/Generating-a-Manifest-File-and-SampleSheet-for-scFlow">page</a></p>
<p>The basic <code>scFlow</code> workflow for sample QC begins with the import of the feature-barcode sparse matrix with <code>read_sparse_matrix</code>. The metadata for the sample is then imported from a sample sheet with <code>read_metadata</code>. A SingleCellExperiment object is created from the matrix and the metadata using <code>generate_sce</code> which is then annotated with both gene and cell-level data using <code>annotate_sce</code>. We then filter the SingleCellExperiment to select only cells and genes meeting our QC criteria using <code>filter_sce</code>. We can then optionally find singlets in our filtered SingleCellExperiment using <code>find_singlets</code> before filtering them out again with <code>filter_sce</code>. A complete QC report can then be generated using <code>report_qc_sce</code> before saving the filtered and quality-controlled SingleCellExperiment with <code>write_sce</code>.</p>
<div id="step-one---import-the-matrix-and-metadata" class="section level3">
<h3 class="hasAnchor">
<a href="#step-one---import-the-matrix-and-metadata" class="anchor"></a>Step one - import the matrix and metadata</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">matrix_fp &lt;-<span class="st"> "path/to/matrix/file"</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">samplesheet_fp &lt;-<span class="st"> "path/to/SampleSheet.tsv"</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">ensembl_fp &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="dt">package =</span> <span class="st">"scFlowData"</span>), <span class="st">"/"</span>, <span class="st">"ensembl_mappings.tsv"</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(scFlow)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">mat &lt;-<span class="st"> </span><span class="kw"><a href="reference/read_sparse_matrix.html">read_sparse_matrix</a></span>(matrix_fp)</a></code></pre></div>
<p>Next we retrieve the metadata by pointing to a Sample Sheet and specifying a unique identifier (unique_key) in a specific column (key_colname):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">metadata &lt;-<span class="st"> </span><span class="kw"><a href="reference/read_metadata.html">read_metadata</a></span>(</a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="dt">unique_key =</span> <span class="st">"fonij"</span>,</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="dt">key_colname =</span> <span class="st">"manifest"</span>,</a>
<a class="sourceLine" id="cb11-4" data-line-number="4"><span class="dt">samplesheet_path =</span> samplesheet_fp</a>
<a class="sourceLine" id="cb11-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="co">#&gt; ══ Retrieving sample metadata ════════════════════════════════════════════════════════════════════════════════════ </span></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="co">#&gt; Reading /home/nfancy/R/x86_64-pc-linux-gnu-library/3.6/scFlowData/extdata/vignette_data/SampleSheet.tsv  </span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8"><span class="co">#&gt; ✔ Four metadata variables loaded for manifest='fonij'</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9"><span class="co">#&gt; manifest: fonij (factor)</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10"><span class="co">#&gt; individual: 1 (integer)</span></a>
<a class="sourceLine" id="cb11-11" data-line-number="11"><span class="co">#&gt; diagnosis: Cases (factor)</span></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"><span class="co">#&gt; sex: F (factor)</span></a></code></pre></div>
<p>For downstream analyses it’s important that the variable classes are correctly specified. Carefully inspect the metadata classes in brackets. In the above example we see that the <em>individual</em> were imported as integer rather than factor variables. Let’s correct this by reloading the metadata, this time specifying the correct variable classes for this variable:-</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">var_classes &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="dt">individual =</span> <span class="st">"factor"</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">metadata &lt;-<span class="st"> </span><span class="kw"><a href="reference/read_metadata.html">read_metadata</a></span>(</a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="dt">unique_key =</span> <span class="st">"lodut"</span>,</a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="dt">key_colname =</span> <span class="st">"manifest"</span>,</a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="dt">samplesheet_path =</span> samplesheet_fp,</a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="dt">col_classes =</span> var_classes</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">)</a></code></pre></div>
<p>With the metadata imported with the correct variable classes, and the previously loaded sparse matrix, we can generate our <code>SingleCellExperiment</code> object:-</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">sce &lt;-<span class="st"> </span><span class="kw"><a href="reference/generate_sce.html">generate_sce</a></span>(mat, metadata)</a></code></pre></div>
<p>The SingleCellExperiment object was succesfully created and we can now proceed with annotation.</p>
</div>
<div id="step-two-annotate-the-singlecellexperiment" class="section level3">
<h3 class="hasAnchor">
<a href="#step-two-annotate-the-singlecellexperiment" class="anchor"></a>Step two – Annotate the SingleCellExperiment</h3>
<p>In <code>scFlow</code> we specify all of our QC preferences and cutoffs with the <code>annotate_sce</code> command. This will also produce plots in the <code>sce@metadata</code> slot allowing rapid revision and optimization of QC parameters. Let’s start with the default parameters by simply providing the <code>SingleCellExperiment</code> object to the <code>annotate_sce</code> function:-</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1">sce &lt;-<span class="st"> </span><span class="kw"><a href="reference/annotate_sce.html">annotate_sce</a></span>(</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">  sce,</a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  <span class="dt">ensembl_mapping_file =</span> ensembl_fp</a>
<a class="sourceLine" id="cb14-4" data-line-number="4">)</a></code></pre></div>
<p>A list of QC plots are available to browse in the <code>sce@metadata$qc_plots</code>, e.g.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">sce<span class="op">@</span>metadata<span class="op">$</span>qc_plots<span class="op">$</span>number_genes_vs_count_depth</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-18-1.png" width="100%"></p>
<p>After running <code>annotate_sce</code> we may examine the plots and assess whether the applied thresholds are sensible for the sample. The effects of different parameters can be explored by iterating through the above <code>generate_sce</code> and <code>annotate_sce</code> functions until satisfied with the settings.</p>
<p>The next step is to filter the SingleCellExperiment with <code>filter_sce</code>: -</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">sce &lt;-<span class="st"> </span><span class="kw"><a href="reference/filter_sce.html">filter_sce</a></span>(sce)</a></code></pre></div>
</div>
<div id="step-three-finding-singlets-and-discarding-multiplets" class="section level3">
<h3 class="hasAnchor">
<a href="#step-three-finding-singlets-and-discarding-multiplets" class="anchor"></a>Step three – Finding singlets and discarding multiplets</h3>
<p>At this stage we may wish to identify singlets in the <code>SingleCellExperiment</code> and discard any multiplets. In <code>scFlow</code> we simply run <code>find_singlets</code> and specify our preferred multiplet identification algorithm. Here we will use <code>doubletfinder</code> (This will take a while depending on the cell numbers):-</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">sce &lt;-<span class="st"> </span><span class="kw"><a href="reference/find_singlets.html">find_singlets</a></span>(sce, <span class="st">"doubletfinder"</span>, <span class="dt">pK =</span> <span class="fl">0.005</span>, <span class="dt">vars_to_regress_out =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"nCount_RNA"</span>, <span class="st">"pc_mito"</span>))</a></code></pre></div>
<p>Now we can filter out these multiplets with <code>filter_sce</code>:-</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">sce &lt;-<span class="st"> </span><span class="kw"><a href="reference/filter_sce.html">filter_sce</a></span>(sce)</a></code></pre></div>
<p>You can see the remaining cells after all the filtering done by:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(sce)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="co">#&gt; [1] 8502 2148</span></a></code></pre></div>
<p>Finally we produce a report with <code>report_qc_sce</code> (this takes a few minutes): -</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="reference/report_qc_sce.html">report_qc_sce</a></span>(sce, <span class="dt">report_file =</span> <span class="st">"qc_report_scflow_individual_1"</span>)</a></code></pre></div>
<p>And save our SingleCellExperiment: -</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="reference/write_sce.html">write_sce</a></span>(sce, <span class="st">"./sce_individual_1"</span>)</a></code></pre></div>
</div>
<div id="step-four-merging-multiple-datasets-into-one-singlecellexperiment-object" class="section level3">
<h3 class="hasAnchor">
<a href="#step-four-merging-multiple-datasets-into-one-singlecellexperiment-object" class="anchor"></a>Step four – Merging multiple datasets into one <em>SingleCellExperiment</em> object</h3>
<p>Follow step one-three for all individual samples and save them using <code>write_sce</code> function. Then we read the individual <code>SingleCellExperiment</code> using <code>read_sce</code> into a list and merge them using <code>merge_sce</code> function.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">sce_path &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span>(</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">  <span class="dt">path =</span> <span class="st">"/path/to/dir"</span>,</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">  <span class="dt">pattern =</span> <span class="st">"sce_individual"</span>,</a>
<a class="sourceLine" id="cb22-4" data-line-number="4">  <span class="dt">full.names =</span> <span class="ot">TRUE</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">)</a>
<a class="sourceLine" id="cb22-6" data-line-number="6"></a>
<a class="sourceLine" id="cb22-7" data-line-number="7">sce_pathlist &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>()</a>
<a class="sourceLine" id="cb22-8" data-line-number="8"></a>
<a class="sourceLine" id="cb22-9" data-line-number="9"><span class="cf">for</span> (i <span class="cf">in</span> sce_path) {</a>
<a class="sourceLine" id="cb22-10" data-line-number="10">  sce_pathlist[[i]] &lt;-<span class="st"> </span>i</a>
<a class="sourceLine" id="cb22-11" data-line-number="11">}</a>
<a class="sourceLine" id="cb22-12" data-line-number="12"></a>
<a class="sourceLine" id="cb22-13" data-line-number="13">sce_list &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(sce_pathlist, read_sce)</a>
<a class="sourceLine" id="cb22-14" data-line-number="14"></a>
<a class="sourceLine" id="cb22-15" data-line-number="15">sce_merged &lt;-<span class="st"> </span><span class="kw"><a href="reference/merge_sce.html">merge_sce</a></span>(</a>
<a class="sourceLine" id="cb22-16" data-line-number="16">  sce_list,</a>
<a class="sourceLine" id="cb22-17" data-line-number="17">  <span class="dt">ensembl_mapping_file =</span> ensembl_fp</a>
<a class="sourceLine" id="cb22-18" data-line-number="18">)</a></code></pre></div>
<p>Then we write the merged <code>SingleCellExperiment</code> object.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="reference/write_sce.html">write_sce</a></span>(</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">  <span class="dt">sce =</span> sce_merged,</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">  <span class="dt">folder_path =</span> <span class="st">"./sce_merged"</span></a>
<a class="sourceLine" id="cb23-4" data-line-number="4">)</a></code></pre></div>
</div>
<div id="step-five-dimension-reduction-and-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#step-five-dimension-reduction-and-clustering" class="anchor"></a>Step five – Dimension reduction and clustering</h3>
<p>Once we merge all the samples into one <code>SingleCellExperiment</code> object we can move to the next steps of dimension reduction and clustering. Here dimension reduction is performed using multiple methods by default i.e. “PCA”, “tSNE”, “UMAP”, “UMAP3D”. Once the dimension reduction step is done the <code>SingleCellExperiment</code> object is ready for clustering.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/dim.html">dim</a></span>(sce_merged)</a>
<a class="sourceLine" id="cb24-2" data-line-number="2"><span class="co">#&gt; [1] 10184 12859</span></a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1">sce_merged &lt;-<span class="st"> </span><span class="kw"><a href="reference/reduce_dims_sce.html">reduce_dims_sce</a></span>(sce_merged, <span class="dt">pca_dims =</span> <span class="dv">5</span>)</a></code></pre></div>
<p>We can now plot tSNE:-</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw"><a href="reference/plot_reduced_dim.html">plot_reduced_dim</a></span>(sce_merged, <span class="dt">feature_dim =</span> <span class="st">"diagnosis"</span>, <span class="dt">reduced_dim =</span> <span class="st">"tSNE"</span>, <span class="dt">alpha =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-30-1.png" width="100%"></p>
<p>The next step is to cluster all the cells using <code>cluster_sce</code> command.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">sce_merged &lt;-<span class="st"> </span><span class="kw"><a href="reference/cluster_sce.html">cluster_sce</a></span>(sce_merged)</a></code></pre></div>
<p>We can then plot the clusters:-</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw"><a href="reference/plot_reduced_dim.html">plot_reduced_dim</a></span>(sce_merged, <span class="dt">feature_dim =</span> <span class="st">"clusters"</span>, <span class="dt">reduced_dim =</span> <span class="st">"tSNE"</span>, <span class="dt">alpha =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-32-1.png" width="100%"></p>
<p>The next step is to annotate the celltypes for each cluster. Here, we will use the package <code>ewce</code>. For this we use the following command (This may take a while):-</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">sce_merged &lt;-<span class="st"> </span><span class="kw"><a href="reference/map_celltypes_sce.html">map_celltypes_sce</a></span>(sce_merged,</a>
<a class="sourceLine" id="cb29-2" data-line-number="2">  <span class="dt">ctd_folder =</span> <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="dt">package =</span> <span class="st">"scFlowData"</span>), <span class="st">"/"</span>, <span class="st">"ctd"</span>, <span class="dt">sep =</span> <span class="st">""</span>)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3">)</a></code></pre></div>
<p>The celltypes for each cell can be found in <code>sce_merged@colData$cluster_celltype</code> slot. We can also generate tSNE plot for each celltype.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw"><a href="reference/plot_reduced_dim.html">plot_reduced_dim</a></span>(sce_merged, <span class="dt">feature_dim =</span> <span class="st">"cluster_celltype"</span>, <span class="dt">reduced_dim =</span> <span class="st">"tSNE"</span>, <span class="dt">alpha =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-34-1.png" width="100%"></p>
</div>
<div id="step-six-performing-differential-expression-analysis-following-by-impacted-pathway-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#step-six-performing-differential-expression-analysis-following-by-impacted-pathway-analysis" class="anchor"></a>Step six – Performing differential expression analysis following by impacted pathway analysis</h3>
<p>We need to subset the merged <code>SingleCellExperiment</code> object to perform differential expression analysis. Here we are using <code>MASTZLM</code> for differential expression analysis. For example, we are interested in performing DE analysis in the <code>IN-SST</code> cell cluster. So, we first subset the <code>IN-SST</code> cluster.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">sce_subset &lt;-<span class="st"> </span>sce_merged[, sce_merged<span class="op">$</span>cluster_celltype <span class="op">==</span><span class="st"> "IN-SST"</span>]</a></code></pre></div>
<p>We need to specify the colData column name as dependent_var as the variable of interest for DE analysis. For example here we want to perform DE analysis between Case and Controls which is found in <code>diagnosis</code> column. ref_class is the reference group for DE analysis. If there are any confounding variables those colData names can be passed through confounding_vars argument.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">result_de &lt;-<span class="st"> </span><span class="kw"><a href="reference/perform_de.html">perform_de</a></span>(</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">  sce_subset,</a>
<a class="sourceLine" id="cb32-3" data-line-number="3">  <span class="dt">dependent_var =</span> <span class="st">"diagnosis"</span>,</a>
<a class="sourceLine" id="cb32-4" data-line-number="4">  <span class="dt">ref_class =</span> <span class="st">"Controls"</span>,</a>
<a class="sourceLine" id="cb32-5" data-line-number="5">  <span class="dt">confounding_vars =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"cngeneson"</span>, <span class="st">"sex"</span>),</a>
<a class="sourceLine" id="cb32-6" data-line-number="6">  <span class="dt">ensembl_mapping_file =</span> ensembl_fp)</a></code></pre></div>
<p>result_de is a list of DE tables. If there are more than one group to be compared against the reference (here <code>Controls</code>) group they will all be merged into the <code>result_de@Controls_Merged_Results</code> slot.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(result_de<span class="op">$</span>Controls_vs_diagnosisCases, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="co">#&gt;   ensembl_gene_id          pval    logFC    ci.hi    ci.lo   gene_biotype</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="co">#&gt; 1 ENSG00000122585 2.080333e-146 3.672375 3.922793 3.421956 protein_coding</span></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="co">#&gt; 2 ENSG00000109846  0.000000e+00 2.467718 2.547119 2.388317 protein_coding</span></a>
<a class="sourceLine" id="cb33-5" data-line-number="5"><span class="co">#&gt; 3 ENSG00000125869  0.000000e+00 2.337181 2.407184 2.267177 protein_coding</span></a>
<a class="sourceLine" id="cb33-6" data-line-number="6"><span class="co">#&gt; 4 ENSG00000128683 2.249204e-300 1.880722 1.972310 1.789133 protein_coding</span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7"><span class="co">#&gt; 5 ENSG00000102804 9.839248e-288 1.812161 1.900221 1.724101 protein_coding</span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8"><span class="co">#&gt;      gene percentage_gene_gc_content          padj       contrast</span></a>
<a class="sourceLine" id="cb33-9" data-line-number="9"><span class="co">#&gt; 1     NPY                      43.41 3.934699e-144 diagnosisCases</span></a>
<a class="sourceLine" id="cb33-10" data-line-number="10"><span class="co">#&gt; 2   CRYAB                      46.12  0.000000e+00 diagnosisCases</span></a>
<a class="sourceLine" id="cb33-11" data-line-number="11"><span class="co">#&gt; 3   LAMP5                      42.77  0.000000e+00 diagnosisCases</span></a>
<a class="sourceLine" id="cb33-12" data-line-number="12"><span class="co">#&gt; 4    GAD1                      45.82 2.056147e-297 diagnosisCases</span></a>
<a class="sourceLine" id="cb33-13" data-line-number="13"><span class="co">#&gt; 5 TSC22D1                      38.08 6.746034e-285 diagnosisCases</span></a>
<a class="sourceLine" id="cb33-14" data-line-number="14"><span class="co">#&gt;   reference                    model</span></a>
<a class="sourceLine" id="cb33-15" data-line-number="15"><span class="co">#&gt; 1  Controls ~diagnosis+cngeneson+sex</span></a>
<a class="sourceLine" id="cb33-16" data-line-number="16"><span class="co">#&gt; 2  Controls ~diagnosis+cngeneson+sex</span></a>
<a class="sourceLine" id="cb33-17" data-line-number="17"><span class="co">#&gt; 3  Controls ~diagnosis+cngeneson+sex</span></a>
<a class="sourceLine" id="cb33-18" data-line-number="18"><span class="co">#&gt; 4  Controls ~diagnosis+cngeneson+sex</span></a>
<a class="sourceLine" id="cb33-19" data-line-number="19"><span class="co">#&gt; 5  Controls ~diagnosis+cngeneson+sex</span></a></code></pre></div>
<p>We have implimented both topology based and non-topology based pathway enrichment analysis. Here we will use ROntoTools and WebGestaltR respectively.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">enrichment_result_webgestaltr &lt;-<span class="st"> </span><span class="kw">pathway_analysis_webgestalt</span>(</a>
<a class="sourceLine" id="cb34-2" data-line-number="2">  <span class="dt">gene_file =</span> result_de<span class="op">$</span>Controls_vs_diagnosisCases,</a>
<a class="sourceLine" id="cb34-3" data-line-number="3">  <span class="dt">enrichment_method =</span> <span class="st">"ORA"</span>,</a>
<a class="sourceLine" id="cb34-4" data-line-number="4">  <span class="dt">project_name =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb34-5" data-line-number="5">  <span class="dt">additional_enrichment_databse =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb34-6" data-line-number="6">  <span class="dt">is_output =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb34-7" data-line-number="7">  <span class="dt">output_dir =</span> <span class="st">"~/"</span></a>
<a class="sourceLine" id="cb34-8" data-line-number="8">)</a></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">enrichment_result_webgestaltr<span class="op">$</span>pathway_KEGG[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">9</span>)]</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="co">#&gt;     geneSet                          description       pValue          FDR</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="co">#&gt; 25 hsa03010                             Ribosome 0.000000e+00 0.000000e+00</span></a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co">#&gt; 53 hsa04723 Retrograde endocannabinoid signaling 6.661338e-15 4.360034e-13</span></a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="co">#&gt; 63 hsa04727                    GABAergic synapse 1.285971e-11 7.081007e-10</span></a>
<a class="sourceLine" id="cb35-6" data-line-number="6"><span class="co">#&gt; 74 hsa05032                   Morphine addiction 1.045983e-09 4.903399e-08</span></a>
<a class="sourceLine" id="cb35-7" data-line-number="7"><span class="co">#&gt; 79 hsa04725                  Cholinergic synapse 4.169939e-09 1.831078e-07</span></a>
<a class="sourceLine" id="cb35-8" data-line-number="8"></a>
<a class="sourceLine" id="cb35-9" data-line-number="9">enrichment_result_webgestaltr<span class="op">$</span>plot<span class="op">$</span>pathway_KEGG</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-41-1.png" width="100%"></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb36-2" data-line-number="2">enrichment_result_rontotools &lt;-<span class="st"> </span><span class="kw"><a href="reference/pathway_analysis_rontotools.html">pathway_analysis_rontotools</a></span>(</a>
<a class="sourceLine" id="cb36-3" data-line-number="3">  <span class="dt">gene_file =</span> result_de<span class="op">$</span>Controls_vs_diagnosisCases,</a>
<a class="sourceLine" id="cb36-4" data-line-number="4">  <span class="dt">project_name =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb36-5" data-line-number="5">  <span class="dt">enrichment_database =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"kegg"</span>, <span class="st">"reactome"</span>, <span class="st">"nci"</span>, <span class="st">"panther"</span>),</a>
<a class="sourceLine" id="cb36-6" data-line-number="6">  <span class="dt">is_output =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb36-7" data-line-number="7">  <span class="dt">output_dir =</span> <span class="st">"~/"</span></a>
<a class="sourceLine" id="cb36-8" data-line-number="8">)</a></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">enrichment_result_rontotools<span class="op">$</span>kegg[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">6</span>,<span class="dv">7</span>)]</a>
<a class="sourceLine" id="cb37-2" data-line-number="2"><span class="co">#&gt;     geneSet                        description      pValue        FDR</span></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="co">#&gt; 1 hsa:00010       Glycolysis / Gluconeogenesis 0.004975124 0.01129865</span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="co">#&gt; 2 hsa:00120     Primary bile acid biosynthesis 0.004975124 0.01129865</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="co">#&gt; 3 hsa:00230                  Purine metabolism 0.004975124 0.01129865</span></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="co">#&gt; 4 hsa:00410            beta-Alanine metabolism 0.004975124 0.01129865</span></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"><span class="co">#&gt; 5 hsa:00430 Taurine and hypotaurine metabolism 0.004975124 0.01129865</span></a>
<a class="sourceLine" id="cb37-8" data-line-number="8"></a>
<a class="sourceLine" id="cb37-9" data-line-number="9">enrichment_result_rontotools<span class="op">$</span>plot<span class="op">$</span>kegg</a></code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-43-1.png" width="100%"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/combiz/scFlow">https://​github.com/​combiz/​scFlow</a>
</li>
<li>Report a bug at <br><a href="https://github.com/combiz/scFlow/issues">https://​github.com/​combiz/​scFlow/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Combiz Khozoie <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/YOUR-ORCID-ID" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID"></a> </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/combiz/scFlow"><img src="https://travis-ci.org/combiz/scFlow.svg?branch=master" alt="Travis build status"></a></li>
<li><a href="https://codecov.io/gh/combiz/scFlow?branch=master"><img src="https://codecov.io/gh/combiz/scFlow/branch/master/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://ci.appveyor.com/project/combiz/scFlow"><img src="https://ci.appveyor.com/api/projects/status/github/combiz/scFlow?branch=master&amp;svg=true" alt="AppVeyor build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Combiz Khozoie.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
